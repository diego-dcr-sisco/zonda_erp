var selected_technicians = $("#technicians").val();
selected_technicians = selected_technicians ? JSON.parse(selected_technicians) : [];

function setAllTechnicians(element) {
    const technicians = $('.technician');
    
    if (element.checked) {
        technicians.prop('checked', true);  // Marca todos los checkboxes
        selected_technicians = technicians.map(function() {
            return parseInt(this.value);
        }).get();  // Almacena los valores en un array
    } else {
        technicians.prop('checked', false);  // Desmarca todos los checkboxes
        selected_technicians = [];  // Limpia el array
    }

    $("#technicians").val(JSON.stringify(selected_technicians));
}

function setTechnician(element) {
    var value = parseInt(element.value)
    if(element.checked) {
        if(!selected_technicians.includes(value)) {
            selected_technicians.push(value);
        }
    } else {
        if(selected_technicians.includes(value)) {
            selected_technicians = selected_technicians.filter(item => item != value);
        }
    }

    $("#technicians").val(JSON.stringify(selected_technicians));
}

function setModalTechnician(contract_id) {
    var input = "#technicians" + contract_id;
    var data_class = ".technician" + contract_id;
    var checked_data = [];
    var zeroChecked = false;

    $(data_class).each(function () {
        if ($(this).is(":checked")) {
            if (parseInt($(this).val()) == 0) {
                checked_data = [parseInt($(this).val())];
                zeroChecked = true;
                return false;
            } else {
                checked_data.push(parseInt($(this).val()));
            }
        }
    });

    if (zeroChecked) {
        $(data_class).not('[value="0"]').prop("disabled", true);
    } else {
        $(data_class).prop("disabled", false);
    }

    $(input).val(JSON.stringify(checked_data));
}
